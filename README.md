#Транспортный каталог
Программа для построения транспортных маршрутов между остановками общественного транспорта и маршрутов до организаций.  
Маршрут выдается в формате JSON, содержащем карту маршрута в SVG-формате, а так же параметры маршрута - время в пути, требуемые номера автобусов, пересадочные остановки.

#Установка
###Требования
Установленный Google Protobuf.

###Сборка (для Eclipse IDE)
1. Создать на одном уровне с папкой `src` папку `build`
2. Перейти в папку `build` и выполнить команду `cmake.exe -G "Eclipse CDT-4 MinGW Makefiles" -DCMAKE_PREFIX_PATH={path to brotobuf} ..\src`
3. В Eclipse IDE сделать импорт собранного проекта из папки build

#Использование

	transport_catalog_part_r [make_base|process_requests|run_tests]

Опция `make_base` - создание транспортного каталога и его сериализация с использование Google Protobuf.
Опция `process_requests` - десериализация каталога и обработка информационных запросов.

###Формат входных данных для построения каталога (опция make_base)
Программа считывает данные для построения транспортного каталога из стандартного потока ввода в формате JSON.
Шаблон входного JSON:  

	{  
		"serialization_settings": {...},  
		"routing_settings": {...},  
		"base_requests": [...], 
		"render_settings": {...},  
		"yellow_pages": {...}  
	}  

####Ключ "serialization_settings"

Ключ задает имя файла, в который будет сериализован транспортный каталог. 
Программа автоматически не создает директорию, в которой будет расположен файл. Для корректной работы программы необходимо создать этот каталог  
перед ее вызовом.

	"serialization_settings": {
		"file": "FILENAME"
	}

####Ключ "routing_settings"

Ключ задает настройки маршрутизатора, которые будут использованы при построении маршрутов. Содержит три обязательных поля:
1. "bus_wait_time" - время ожидания автобуса на остановке в минутах. Считается, что пассажир ждет автобуса bus_wait_time минут при посадке в автобус и на пересадочных остановках, если такие имеются.
2. "bus_velocity" - скорость автобуса в км/ч.
3. "pedestrian_velocity" - скорость пешехода в км/ч, используется при построении маршрутов до организаций.

Пример:

	"routing_settings": {
        "bus_wait_time": 2,
        "bus_velocity": 30,
        "pedestrian_velocity": 5
    }

####Ключ "base_requests"

Ключ задает массив запросов для создания справочника. Запросы бывают двух типов: `bus` и `stop`. Запрос типа `bus` задает параметры автобуса, `stop` - параметры остановки. 

#####Запрос "Bus"

Поля запроса:  

1. "type" - определяет тип запроса. Для автобуса должен иметь значение "Bus".  
2. "name" - название (номер маршрута) автобуса. Значение - любая (уникальная в рамках работы программы) строка.  
3. "is_roundtrip" - кольцевой маршрут или нет. Значение - true или false. Для кольцевого маршрута первая и последняя остановки в описании (см. ниже) совпадают, для некольцевого - нет. Для некольцевого маршрута считается, что автобус проходит все остановки в порядке, заданным описанием маршрута, а затем в обратном порядке. По кольцевому маршруту автобус движется лишь в одну сторону. На конечной (она же - начальная) остановке кольцевого маршрута автобус высаживает всех пассажиров, и при необходимости дальнейшего следования по этому маршруту они ожидают bus_wait_time минут на конечной. На конечных остановках некольцевых маршрутов также происходит высадка всех пассажиров.  
4. "stops" - массив названий остановок в порядке следования. Если машрут кольцевой, то первая и последняя остановки в описании должны совпадать.  

Пример:

	{
        "type": "Bus",
        "name": "13",
        "stops": [
            "Улица Лизы Чайкиной",
            "Пионерская улица, 111",
            "Садовая",
            "Театральная"
        ],
        "is_roundtrip": false
    }
Задает некольцевой маршрут с названием "13", следующего по маршруту Улица Лизы Чайкиной -> Пионерская улица, 111 -> Садовая -> Театральная -> Садовая -> Пионерская улица, 111 -> Улица Лизы Чайкиной.

Запрос

	{
        "type": "Bus",
        "name": "14a",
        "stops": [
            "Улица Лизы Чайкиной",
            "По требованию",
            "Улица Докучаева",
            "Улица Лизы Чайкиной"
        ],
        "is_roundtrip": true
    }
Создает кольцевой маршрут Улица Лизы Чайкиной -> По требованию -> Улица Докучаева -> Улица Лизы Чайкиной с названием "14a".

#####Запрос "Stop"

1. "type" - определяет тип запроса. Для остановки должен иметь значение "Stop".  
2. "name" - название остановки. Значение - любая (уникальная в рамках работы программы) строка.  
3. "latitude" - географическая широта остановки в десятичной записи.  
4. "longitude" - географическая долгота остановки в десятичной записи.  
4. "road_distances" - словарь, указывающий физические расстояния до соседних остановок в метрах. Данные расстояния могут быть больше расстояния, вычисленного из географических координат. Указываются расстояния лишь для тех остановок, которые соединены какими-либо автобусными маршрутами. Для двух соседних остановок достаточно указать road_distances только в описании одной остановки, однако, для всех остановок, участвующих в построении маршрутов так или иначе должны быть указаны физические расстояния до соседних.  

Пример:

    {
        "type": "Stop",
        "name": "Улица Лизы Чайкиной",
        "latitude": 43.590317,
        "longitude": 39.746833,
        "road_distances": {
            "Пионерская улица, 111": 950
        }
    },
    {
        "type": "Stop",
        "name": "Пионерская улица, 111",
        "latitude": 43.587257,
        "longitude": 39.740325,
        "road_distances": {
            "Садовая": 520
        }
    },
    {
        "type": "Stop",
        "name": "Садовая",
        "latitude": 43.58395,
        "longitude": 39.736938,
        "road_distances": {}
    }

Эти запросы задают корректно задают физичесике расстояния между 3 остановками - "Улица Лизы Чайкиной", "Пионерская улица, 111", "Садовая".

####Ключ "render_settings"